
project(library)
cmake_minimum_required(VERSION 2.8)

include( ${PROJECT_SOURCE_DIR}/OpenLibrary.cmake )
include( ${PROJECT_SOURCE_DIR}/cmake/functions.cmake )
include( ${PROJECT_SOURCE_DIR}/cmake/cmake_tests.cmake )
set(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake)

#prepare target for autogenerated files, and for running tests
add_custom_target(autogenerated)           #all generated files (which will rarely change) used for futher compilation should attach here (like flex/bison c/h files, images (svg->png) etc)
add_custom_target(test)                    #all internal test targets should attach here

#prepare target for cration of cmake variables for each sub-library of OpenLibrary
generate_variables_file()

unset(OPENLIBRARY_REGISTERED_LIBRARIES CACHE)

#generate file with export/import stuff for sublibraries
prepareExportFile(${PROJECT_SOURCE_DIR}/OpenLibraryExports.hpp)

add_subdirectory(htmlParser htmlParser)
#add_subdirectory(qextserialport qextserialport)
add_subdirectory(router router)
add_subdirectory(QtExt QtExt)
add_subdirectory(utils utils)
add_subdirectory(math math)

set(LIBRARY_HEADERS debug.hpp std_macros.hpp str_op.hpp)

register_library(common HEADERS ${LIBRARY_HEADERS})

#create cmake tests
runTests()
